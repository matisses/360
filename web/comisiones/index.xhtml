<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:m="http://java.sun.com/jsf/composite/matisses"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

    <h:head>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" http-equiv="Content-Type"/>
        <link href="/360/css/bootstrap.min.css" rel="stylesheet"/>
        <link href="/360/css/styles.css" rel="stylesheet"/>
        <link href="/360/css/multileveldropdown.css" rel="stylesheet"/>
        <script type="text/javascript">
            $(window).scroll(function () {
                if ($(this).scrollTop() > 20) {
                    $('#detallePago').attr('class', 'contenedor-detalle-pago-comision contenedor-detalle-pago-comision-scroll');
                } else {
                    $('#detallePago').attr('class', 'contenedor-detalle-pago-comision');
                }
            });

            function openRuta(window_src) {
                ruta = window.open(window_src, 'newwindow', config = 'height=' + window.screen.availHeight + ',width=' + window.screen.availWidth
                        + ',toolbar=no,menubar=no,resizable=no,location=no,status=no,scrollbars=yes');
            }

            function abrirModalDetalleDocumento() {
                $('#modalDetalleDocumento').modal('show');
            }

            function cerrarModalDetalleDocumento() {
                $('modalDetalleDocumento').modal('hide');
                $('body').removeClass('modal-open');
                $('.modal-backdrop').remove();
            }

            function abrirModalAgregarDocumento() {
                $('#modalAgregarDocumento').modal('show');
            }

            function cerrarModalAgregarDocumento() {
                $('modalAgregarDocumento').modal('hide');
                $('body').removeClass('modal-open');
                $('.modal-backdrop').remove();
            }
        </script>
        <script src="/360/js/arriba.js"></script>
        <title>360 - Comisiones</title>
    </h:head>

    <h:body style="padding-right: 0px !important">
        <f:event type="preRenderView" listener="#{userSessionInfoMBean.checkAlreadyLoggedin}"/>
        <m:navbar/>

        <span class="ir-arriba">
            <span class="glyphicon glyphicon-chevron-up" style="top: -2px !important"></span>
        </span>

        <h:panelGroup id="panelDetalleDocumento">
            <h:form id="formDetalleDocumento">
                <div class="modal fade" id="modalDetalleDocumento" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content dialog-content noround">
                            <div class="modal-header dialog-header">
                                <h4 class="modal-title">
                                    Detalle documento
                                </h4>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-xs-6 margin-bottom-10">
                                        <b>Documento: </b>#{comisionesMBean.documento}
                                    </div>
                                    <div class="col-xs-6">
                                        <b>Tipo: </b>#{comisionesMBean.tipo}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-12 margin-bottom-10">
                                        <b>Cliente: </b>#{comisionesMBean.cliente}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-12 margin-bottom-10">
                                        <b>Documentos relacionados: </b>#{comisionesMBean.docRelacionados}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-6 margin-bottom-10">
                                        <b>Valor antes de IVA: </b>COP #{baruGenericMBean.getValorFormateado('Double', comisionesMBean.valorAntesIVA, 2)}
                                    </div>
                                    <div class="col-xs-6">
                                        <b>Valor despues de IVA: </b>COP #{baruGenericMBean.getValorFormateado('Double', comisionesMBean.valorDespuesIVA, 2)}
                                    </div>
                                </div>
                                <br/>
                                <div class="row">
                                    <div class="col-xs-12">
                                        <ul class="nav nav-pills">
                                            <li class="active noround">
                                                <a href="#tab_items" class="input-lg noround" data-toggle="pill">
                                                    Ítems
                                                </a>
                                            </li>
                                            <li class="noround">
                                                <a href="#tab_pagos" class="input-lg noround" data-toggle="pill">
                                                    Pagos
                                                </a>
                                            </li>
                                        </ul>

                                        <div class="tab-content">
                                            <div id="tab_items" class="active tab-pane">
                                                <div class="row">
                                                    <div class="col-xs-12">
                                                        <div class="row">
                                                            <ui:repeat value="#{comisionesMBean.detalleDocumento}" var="detalle">
                                                                <div class="col-xs-4">
                                                                    <div style="border: 1px solid #DDDDDD; margin: 5px; padding: 5px; height: 150px">
                                                                        <div class="row">
                                                                            <div class="col-xs-6 center-component">
                                                                                <img class="img-mini" src="#{imagenProductoMBean.obtenerUrlProducto(detalle.referencia, true)}"/>
                                                                            </div>
                                                                            <div class="col-xs-6">
                                                                                <div class="row">
                                                                                    <div class="col-xs-12">
                                                                                        <b style="font-size: 25px">#{baruGenericMBean.convertirARefCorta(detalle.referencia)}</b>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="row">
                                                                                    <div class="col-xs-12 right-component">
                                                                                        <span class="badge badge-gray" style="font-size: 20px">
                                                                                            #{detalle.cantidad}
                                                                                        </span>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="row">
                                                                            <div class="col-xs-12 justify-component">
                                                                                #{baruGenericMBean.obtenerNombreReferencia(detalle.referencia)}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </ui:repeat>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div id="tab_pagos" class="tab-pane">
                                                <div class="row">
                                                    <ui:repeat value="#{comisionesMBean.pagos}" var="pago">
                                                        <div class="col-xs-4">
                                                            <div class="contenedor-pago-comision">
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Fecha recibo:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{pago[0]}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Número recibo:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{pago[1]}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Total recibo:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{baruGenericMBean.getValorFormateado('Double', pago[2], 2)}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Efectivo:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{baruGenericMBean.getValorFormateado('Double', pago[3], 2)}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Cheque:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{baruGenericMBean.getValorFormateado('Double', pago[4], 2)}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Tarjetas:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{baruGenericMBean.getValorFormateado('Double', pago[5], 2)}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Otros:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{baruGenericMBean.getValorFormateado('Double', pago[6], 2)}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Notas credito:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{baruGenericMBean.getValorFormateado('Double', pago[7], 2)}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Fecha reconciliación:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{pago[8]}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Reconciliación:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{baruGenericMBean.getValorFormateado('Double', pago[9], 2)}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Cruce:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{baruGenericMBean.getValorFormateado('Double', pago[10], 2)}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Fecha egreso:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{pago[11]}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Egreso:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{baruGenericMBean.getValorFormateado('Double', pago[12], 2)}
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-7">
                                                                        <b>Balance:</b>
                                                                    </div>
                                                                    <div class="col-xs-5 right-component">
                                                                        #{baruGenericMBean.getValorFormateado('Double', pago[13], 2)}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </ui:repeat>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer dialog-footer">
                                <div class="row">
                                    <div class="col-xs-12 right-component">                                        
                                        <button type="button" class="btn btn-primary btn-lg noround" onclick="deseleccionarDocumento(); cerrarModalDetalleDocumento();" data-dismiss="modal">
                                            Cerrar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </h:form>
        </h:panelGroup>

        <h:panelGroup id="panelAgregarDocumento">
            <h:form id="formAgregarDocumento">
                <div id="modalAgregarDocumento" class="modal fade" tabindex="-1" role="dialog">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content dialog-content">
                            <div class="modal-header dialog-header">
                                <h4 class="modal-title">Agregar documento</h4>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-xs-6">
                                        <div class="row">
                                            <h:panelGroup id="datos">
                                                <div class="col-xs-12 margin-bottom-10">
                                                    <label>Documento</label>
                                                    <h:inputText id="txt_documento" class="form-control input-lg noround" value="#{comisionesMBean.documento}" autocomplete="off" onkeypress="if (event.keyCode === 13) {
                                                                return false;
                                                            }"/>
                                                </div>
                                                <div class="col-xs-12 margin-bottom-10">
                                                    <label>Tipo</label>
                                                    <h:selectOneMenu class="form-control input-lg noround pointer-cursor" value="#{comisionesMBean.tipo}">
                                                        <f:selectItem itemLabel="Seleccione tipo" itemValue=""/>
                                                        <f:selectItem itemLabel="Factura" itemValue="FV"/>
                                                        <f:selectItem itemLabel="Devolución" itemValue="DV"/>
                                                    </h:selectOneMenu>
                                                </div>
                                                <div class="col-xs-12">
                                                    <label>Comentario</label>
                                                    <h:inputTextarea class="form-control input-lg noround" value="#{comisionesMBean.comentario}" style="resize: none; height: 150px"/>
                                                </div>
                                            </h:panelGroup>
                                        </div>
                                    </div>
                                    <div class="col-xs-6 margin-bottom-10">
                                        <p:remoteCommand name="seleccionarDocumentoPendiente" actionListener="#{comisionesMBean.seleccionarDocumentoPendiente}" update=":formAgregarDocumento:datos"/>

                                        <label>Documento disponibles</label>
                                        <div style="height: 313px; overflow-y: auto; overflow-x: hidden">
                                            <div class="row">
                                                <ui:repeat value="#{comisionesMBean.documentosPendientes}" var="documentoPendiente">
                                                    <div class="col-xs-6 margin-bottom-10">
                                                        <div class="pointer-cursor" style="border: 1px solid #DDDDDD; padding: 10px"
                                                             onclick="seleccionarDocumentoPendiente([{name: 'documento', value: '#{documentoPendiente[0]}'}, {name: 'tipo', value: '#{documentoPendiente[1]}'}])">
                                                            <div class="row">
                                                                <div class="col-xs-12">
                                                                    #{documentoPendiente[1]}
                                                                </div>
                                                                <div class="col-xs-12 center-component" style="font-size: 20px">
                                                                    #{documentoPendiente[0]}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </ui:repeat>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer dialog-footer">
                                <p:remoteCommand name="modal1" update=":panelAgregarDocumento" oncomplete="agregarDocumento(); abrirModalEspera();"/>
                                <p:remoteCommand name="agregarDocumento" actionListener="#{comisionesMBean.agregarDocumento}" update=":formComisiones" oncomplete="cerrarModalEspera();"/>

                                <button type="button" class="btn btn-default btn-lg noround" data-dismiss="modal">Cerrar</button>
                                <button type="button" class="btn btn-primary btn-lg noround" onclick="modal1();">Aplicar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </h:form>
        </h:panelGroup>

        <h:panelGroup id="panelAplicarComision">
            <h:form>
                <div id="modalAplicarComision" class="modal fade" tabindex="-1" role="dialog">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content dialog-content noround">
                            <div class="modal-header dialog-header">
                                <h4 class="modal-title">Aplicar comisión</h4>
                            </div>
                            <div class="modal-body">
                                <p class="center-component">
                                    <span class="glyphicon glyphicon-alert" style="color: #F0AD4E; font-size: 16px"></span>
                                    ¿Esta segur@ que desea aplicar la comisión?
                                </p>
                            </div>
                            <div class="modal-footer dialog-footer">
                                <p:remoteCommand name="modal" oncomplete="aplicarComision(); abrirModalEspera();" update=":panelAplicarComision"/>
                                <p:remoteCommand name="aplicarComision" actionListener="#{comisionesMBean.aplicarComision}" oncomplete="cerrarModalEspera();" update=":formComisiones:comision"/>

                                <button type="button" class="btn btn-default btn-lg noround" data-dismiss="modal">Cerrar</button>
                                <button type="button" class="btn btn-primary btn-lg noround" onclick="modal();">Aplicar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </h:form>
        </h:panelGroup>

        <div id="modalBorrarComision" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content dialog-content noround">
                    <h:form>
                        <div class="modal-header dialog-header">
                            <h4 class="modal-title">Borrar comisión</h4>
                        </div>
                        <div class="modal-body">
                            <p class="center-component">
                                <span class="glyphicon glyphicon-alert" style="color: #F0AD4E; font-size: 16px"></span>
                                ¿Esta segur@ que desea borrar la comisión?
                            </p>
                        </div>
                        <div class="modal-footer dialog-footer">
                            <p:remoteCommand name="modalB" oncomplete="borrarComision(); abrirModalEspera();"/>
                            <p:remoteCommand name="borrarComision" actionListener="#{comisionesMBean.borrarComision}" oncomplete="cerrarModalEspera();" update=":formComisiones:comision"/>

                            <button type="button" class="btn btn-default btn-lg noround" data-dismiss="modal">Cerrar</button>
                            <button type="button" class="btn btn-primary btn-lg noround" data-dismiss="modal" onclick="modalB();">Borrar</button>
                        </div>
                    </h:form>
                </div>
            </div>
        </div>

        <h:form id="formComisiones" style="overflow: hidden">
            <div class="row">
                <div class="col-xs-12">
                    <ol class="breadcrumb">
                        <li class="active">
                            <a>Comisiones</a>
                        </li>
                    </ol>
                </div>
            </div>

            <p:remoteCommand name="seleccionarAsesor" actionListener="#{comisionesMBean.seleccionarAsesor}" oncomplete="cerrarModalEspera();"
                             update=":formComisiones:datos :formComisiones:estadoComision :formComisiones:comision :formComisiones:incluir"/>

            <h:panelGroup id="datos">
                <h:panelGroup rendered="#{comisionesMBean.paso eq 1}">
                    <div class="row">
                        <ui:repeat value="#{comisionesMBean.empleadosVenta.entrySet().toArray()}" var="empleado">
                            <div class="col-xs-12 margin-bottom-10">
                                <h3 style="padding-left: 20px">#{empleado.key}</h3>
                            </div>
                            <div class="col-xs-12">
                                <div class="row">
                                    <ui:repeat value="#{empleado.value}" var="value">
                                        <div onclick="abrirModalEspera();
                                                seleccionarAsesor([{name: 'codigoAsesor', value: '#{value.codigoAsesor}'}]);">
                                            <div class="col-lg-2">
                                                <div class="row">
                                                    <div class="col-xs-12 margin-bottom-10 center-component">
                                                        <div class="img-empleado pointer-cursor">
                                                            <img src="#{value.rutaFoto}" class="contenedor-foto-empleado-comision"/>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 center-component margin-bottom-10">
                                                        #{value.nombre}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </ui:repeat>
                                </div>
                            </div>
                        </ui:repeat>
                    </div>
                </h:panelGroup>
                <h:panelGroup rendered="#{comisionesMBean.paso eq 2}">
                    <div class="row">
                        <div class="col-xs-1">
                            <div style="margin-left: 10px">
                                <ui:repeat value="#{comisionesMBean.empleadosVenta.entrySet().toArray()}" var="empleado">
                                    <ui:repeat value="#{empleado.value}" var="value">
                                        <div class="row">
                                            <div onclick="abrirModalEspera(); seleccionarAsesor([{name: 'codigoAsesor', value: '#{value.codigoAsesor}'}]);">
                                                <div class="col-xs-12">
                                                    <div class="row">
                                                        <div class="col-xs-12 margin-bottom-10 center-component">
                                                            <div class="#{value.codigoAsesor eq comisionesMBean.empleado.codigoAsesor ? 'img-empleado-detalle-activo' : 'img-empleado-detalle'} pointer-cursor">
                                                                <img src="#{value.rutaFoto}"
                                                                     class="#{value.codigoAsesor eq comisionesMBean.empleado.codigoAsesor ? '' : 'contenedor-foto-empleado-comision-detalle'}"
                                                                     style="#{value.codigoAsesor eq comisionesMBean.empleado.codigoAsesor ? 'width: 70px; height: 70px; border-radius: 50%; opacity: 0.7' : ''}"/>

                                                                <span class="#{value.codigoAsesor eq comisionesMBean.empleado.codigoAsesor ? 'label-empleado-detalle-activo' : 'label-empleado-detalle'}">
                                                                    #{value.nombre}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </ui:repeat>
                                </ui:repeat>
                            </div>
                        </div>
                        <div class="col-xs-8">
                            <h:panelGroup id="incluir">
                                <ui:fragment rendered="#{comisionesMBean.comisionAprobada == false}">
                                    <div class="row">
                                        <div class="col-xs-12 right-component margin-bottom-10">
                                            <p:remoteCommand name="obtenerDocumentosPendientes" actionListener="#{comisionesMBean.obtenerDocumentosPendientes}"
                                                             oncomplete="cerrarModalEspera(); abrirModalAgregarDocumento();" update=":panelAgregarDocumento"/>

                                            <button type="button" class="btn btn-default btn-lg noround" onclick="abrirModalEspera(); obtenerDocumentosPendientes();">
                                                <span class="glyphicon glyphicon-plus"></span> Agregar documento
                                            </button>
                                        </div>
                                    </div>
                                </ui:fragment>
                            </h:panelGroup>

                            <p:messages id="msg" showDetail="true" showSummary="true"/>

                            <div class="row">
                                <div class="col-xs-12">
                                    <div style="margin: 0 5px">
                                        <h:panelGroup id="documentos">
                                            <p:remoteCommand name="aplicarDocumento" actionListener="#{comisionesMBean.aplicarDocumento}" oncomplete="cerrarModalEspera();"
                                                             update=":formComisiones:documentos :formComisiones:estadoComision"/>
                                            <p:remoteCommand name="seleccionarDocumento" actionListener="#{comisionesMBean.seleccionarDocumento}" update=":panelDetalleDocumento"
                                                             oncomplete="cerrarModalEspera(); abrirModalDetalleDocumento();"/>

                                            <table class="table table-striped table-bordered">
                                                <tr>
                                                    <th class="head-tabla">
                                                        Fecha
                                                    </th>
                                                    <th class="head-tabla">
                                                        Documento
                                                    </th>
                                                    <th class="head-tabla">
                                                        Tipo
                                                    </th>
                                                    <th class="head-tabla">
                                                        % Venta
                                                    </th>
                                                    <th class="head-tabla">
                                                        Valor Documento
                                                    </th>
                                                    <th class="head-tabla">
                                                        Base Comisión
                                                    </th>
                                                    <th class="head-tabla">
                                                        ¿Aplica?
                                                    </th>
                                                </tr>

                                                <ui:repeat value="#{comisionesMBean.datosComision}" var="dato">
                                                    <tr class="pointer-cursor tr-tabla" style="color: #FFFFFF; #{dato.nuevo ? 'background-color: #F8A602' : dato.documentoCerrado == false ?
                                                                                                                 'background-color: #Bf0039' : dato.aplicarDV == false ? 'background-color: #8A6D3B' :
                                                                                                                 'color: #000000 !important'}">
                                                        <td class="center-component"
                                                            onclick="abrirModalEspera(); seleccionarDocumento([{name: 'documento', value: '#{dato.documento}'}, {name: 'tipo', value: '#{dato.tipo}'}]););">
                                                            #{dato.fecha}
                                                        </td>
                                                        <td class="right-component"
                                                            onclick="abrirModalEspera(); seleccionarDocumento([{name: 'documento', value: '#{dato.documento}'}, {name: 'tipo', value: '#{dato.tipo}'}]);">
                                                            #{dato.documento}
                                                        </td>
                                                        <td class="center-component"
                                                            onclick="abrirModalEspera(); seleccionarDocumento([{name: 'documento', value: '#{dato.documento}'}, {name: 'tipo', value: '#{dato.tipo}'}]);">
                                                            #{dato.tipo}
                                                        </td>
                                                        <td class="center-component"
                                                            onclick="abrirModalEspera(); seleccionarDocumento([{name: 'documento', value: '#{dato.documento}'}, {name: 'tipo', value: '#{dato.tipo}'}]);">
                                                            #{baruGenericMBean.getValorFormateado('Double', (dato.porcentajeComision * 100), 2)}%
                                                        </td>
                                                        <td class="right-component"
                                                            onclick="abrirModalEspera(); seleccionarDocumento([{name: 'documento', value: '#{dato.documento}'}, {name: 'tipo', value: '#{dato.tipo}'}]);">
                                                            #{baruGenericMBean.getValorFormateado('Double', dato.valorDocumento, 2)}
                                                        </td>
                                                        <td class="right-component"
                                                            onclick="abrirModalEspera(); seleccionarDocumento([{name: 'documento', value: '#{dato.documento}'}, {name: 'tipo', value: '#{dato.tipo}'}]);">
                                                            <div class="row">
                                                                <div class="col-xs-3 center-component">
                                                                    <span class="#{dato.documentoCerrado == false || dato.incluir == false ? 'glyphicon glyphicon-remove' :
                                                                                   dato.tipo eq 'FV' ? 'glyphicon glyphicon-plus' : 'glyphicon glyphicon-minus'}"
                                                                          style="font-size: 9px; top: -1px; color: #{dato.documentoCerrado == false || dato.aplicarDV == false ? '#FFFFFF' : dato.tipo eq 'FV' ?
                                                                                                                     '#5CB85C' : dato.incluir == false ? '#F0AD4E' : '#D9534F'}"></span>
                                                                </div>
                                                                <div class="col-xs-9 right-component">
                                                                    #{baruGenericMBean.getValorFormateado('Double', dato.valor, 2)}
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="center-component">
                                                            <ui:fragment rendered="#{comisionesMBean.comisionAprobada == false}">
                                                                <span class="glyphicon #{dato.incluir ? 'glyphicon-check' : 'glyphicon-unchecked'} margin-bottom-10 pointer-cursor
                                                                      #{dato.documentoCerrado == false || dato.aplicarDV == false ? 'checkbox-360-negativo' : 'checkbox-360'}"
                                                                      onclick="abrirModalEspera(); aplicarDocumento([{name: 'documento', value: '#{dato.documento}'}]);"></span>
                                                            </ui:fragment>
                                                            <ui:fragment rendered="#{comisionesMBean.comisionAprobada}">
                                                                <span class="glyphicon #{dato.incluir ? 'glyphicon-check' : 'glyphicon-unchecked'} margin-bottom-10 pointer-cursor
                                                                      #{dato.documentoCerrado == false || dato.aplicarDV == false ? 'checkbox-360-negativo' : 'checkbox-360'}"></span>
                                                            </ui:fragment>
                                                        </td>
                                                    </tr>
                                                </ui:repeat>
                                            </table>
                                        </h:panelGroup>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-3">
                            <div class="row">
                                <div class="col-xs-12">
                                    <div id="detallePago" class="contenedor-detalle-pago-comision">
                                        <div class="row">
                                            <div class="col-xs-12">
                                                <h:panelGroup id="estadoComision">
                                                    <div class="row">
                                                        <div class="col-xs-12">
                                                            <p>
                                                                <b>Asesor:</b>
                                                            </p>
                                                            <p class="center-component" style="color: #BF0039">
                                                                <b>#{comisionesMBean.empleado.nombreCompleto}</b>
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-xs-12">
                                                            <p>
                                                                <b>Total venta mobiliario:</b>
                                                            </p>
                                                            <p class="right-component">
                                                                COP #{baruGenericMBean.getValorFormateado('Double', comisionesMBean.acumuladoMobiliario, 2)}
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-xs-12">
                                                            <p>
                                                                <b>Total venta complementos:</b>
                                                            </p>
                                                            <p class="right-component">
                                                                COP #{baruGenericMBean.getValorFormateado('Double', comisionesMBean.acumuladoComplementos, 2)}
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-xs-12">
                                                            <p>
                                                                <b>Total devuelto:</b>
                                                            </p>
                                                            <p class="right-component">
                                                                COP #{baruGenericMBean.getValorFormateado('Double', comisionesMBean.obtenerTotalDevuelto, 2)}
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-xs-12">
                                                            <p>
                                                                <b>Total vendido:</b>
                                                            </p>
                                                            <p class="right-component">
                                                                COP #{baruGenericMBean.getValorFormateado('Double', comisionesMBean.obtenerTotalVendido, 2)}
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <ui:fragment rendered="#{comisionesMBean.comisiona == false or comisionesMBean.obtenerTotalComision lt 0}">
                                                        <div class="row">
                                                            <div class="col-xs-12">
                                                                <p class="justify-component">
                                                                    <span class="glyphicon glyphicon-alert" style="color: #F0AD4E; font-size: 16px"></span>
                                                                    El asesor aún no puede comisionar.
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </ui:fragment>
                                                    <ui:fragment rendered="#{comisionesMBean.comisiona and comisionesMBean.obtenerTotalComision gt 0}">
                                                        <div class="row">
                                                            <div class="col-xs-6 center-component">
                                                                <p>
                                                                    <b>Comisión mob #{comisionesMBean.porcentajeMobiliario}%</b>
                                                                </p>
                                                                <p>
                                                                    COP #{baruGenericMBean.getValorFormateado('Double', (comisionesMBean.acumuladoMobiliario / 100) * comisionesMBean.porcentajeMobiliario, 2)}
                                                                </p>
                                                            </div>
                                                            <ui:fragment rendered="#{comisionesMBean.porcentajeComplementos > 0}">
                                                                <div class="col-xs-6 center-component">
                                                                    <p>
                                                                        <b>Comisión compl #{comisionesMBean.porcentajeComplementos}%</b>
                                                                    </p>
                                                                    <p>
                                                                        COP #{baruGenericMBean.getValorFormateado('Double', (comisionesMBean.acumuladoComplementos / 100) * comisionesMBean.porcentajeComplementos, 2)}
                                                                    </p>
                                                                </div>
                                                            </ui:fragment>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-xs-12">
                                                                <p>
                                                                    <b>Total comisionar:</b>
                                                                </p>
                                                                <p class="right-component color-360-original">
                                                                    <b>COP #{baruGenericMBean.getValorFormateado('Double', comisionesMBean.obtenerTotalComision, 2)}</b>
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </ui:fragment>
                                                </h:panelGroup>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-5">
                                                <p:remoteCommand name="seleccionarYear" actionListener="#{comisionesMBean.seleccionarYear}" oncomplete="cerrarModalEspera();"
                                                                 update=":formComisiones:years :formComisiones:documentos :formComisiones:estadoComision :formComisiones:comision :formComisiones:incluir"/>
                                                <div class="form-group">
                                                    <h:outputLabel value="Año:"/>
                                                    <h:panelGroup id="years">
                                                        <div class="dropdown">
                                                            <button type="button" class="btn btn-default dropdown-toggle input-lg noround" style="width: 100%"
                                                                    id="selYear" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                                                #{comisionesMBean.yearSeleccionado}
                                                                <span class="caret"></span>
                                                            </button>
                                                            <ul class="dropdown-menu dropdown-menu-size" aria-labelledby="selYear">
                                                                <ui:repeat value="#{comisionesMBean.years}" var="year">
                                                                    <li>
                                                                        <a class="pointer-cursor" onclick="abrirModalEspera(); seleccionarYear([{name: 'year', value: '#{year}'}]);">
                                                                            #{year}
                                                                        </a>
                                                                    </li>
                                                                </ui:repeat>
                                                            </ul>
                                                        </div>
                                                    </h:panelGroup>
                                                </div>
                                            </div>
                                            <div class="col-xs-7">
                                                <p:remoteCommand name="seleccionarMonth" actionListener="#{comisionesMBean.seleccionarMonth}" oncomplete="cerrarModalEspera();"
                                                                 update=":formComisiones:months :formComisiones:documentos :formComisiones:estadoComision :formComisiones:comision :formComisiones:incluir"/>
                                                <div class="form-group" style="margin-bottom: 5px !important">
                                                    <h:outputLabel value="Mes:"/>
                                                    <h:panelGroup id="months">
                                                        <div class="dropdown">
                                                            <button type="button" class="btn btn-default dropdown-toggle input-lg noround" style="width: 100%"
                                                                    id="selMonth" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                                                #{comisionesMBean.monthSeleccionado}
                                                                <span class="caret"></span>
                                                            </button>
                                                            <ul class="dropdown-menu dropdown-menu-size" aria-labelledby="selMonth">
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera(); seleccionarMonth([{name: 'month', value: '1'}]);">
                                                                        Enero
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera();
                                                                            seleccionarMonth([{name: 'month', value: '2'}]);">
                                                                        Febrero
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera();
                                                                            seleccionarMonth([{name: 'month', value: '3'}]);">
                                                                        Marzo
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera();
                                                                            seleccionarMonth([{name: 'month', value: '4'}]);">
                                                                        Abril
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera();
                                                                            seleccionarMonth([{name: 'month', value: '5'}]);">
                                                                        Mayo
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera();
                                                                            seleccionarMonth([{name: 'month', value: '6'}]);">
                                                                        Junio
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera();
                                                                            seleccionarMonth([{name: 'month', value: '7'}]);">
                                                                        Julio
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera(); seleccionarMonth([{name: 'month', value: '8'}]);">
                                                                        Agosto
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera();
                                                                            seleccionarMonth([{name: 'month', value: '9'}]);">
                                                                        Septiembre
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera();
                                                                            seleccionarMonth([{name: 'month', value: '10'}]);">
                                                                        Octubre
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera();
                                                                            seleccionarMonth([{name: 'month', value: '11'}]);">
                                                                        Noviembre
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="pointer-cursor" onclick="abrirModalEspera(); seleccionarMonth([{name: 'month', value: '12'}]);">
                                                                        Diciembre
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </h:panelGroup>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-12 margin-bottom-10">
                                                <h:panelGroup id="comision">
                                                    <ui:fragment rendered="#{comisionesMBean.comisionAprobada == false}">
                                                        <div class="row">
                                                            <div class="col-xs-12">
                                                                <button type="button" class="btn btn-primary btn-lg noround" style="width: 100%" data-toggle="modal" data-target="#modalAplicarComision">
                                                                    ¿Aplicar comisión?
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </ui:fragment>
                                                    <ui:fragment rendered="#{comisionesMBean.comisionAprobada}">
                                                        <div class="row">
                                                            <div class="col-xs-4 center-component margin-bottom-10">
                                                                <img src="#{baruGenericMBean.obtenerRutaFotoEmpleadoComision(comisionesMBean.aprobador)}" style="border-radius: 50%; height: 50px"/>
                                                            </div>
                                                            <div class="col-xs-8 center-component margin-bottom-10">
                                                                <div class="row">
                                                                    <div class="col-xs-6 center-component">
                                                                        <span class="glyphicon glyphicon-ok" style="color: #3C763D; font-size: 30px; margin-top: 10px"></span>
                                                                    </div>
                                                                    <div class="col-xs-6 center-component">
                                                                        <span class="glyphicon glyphicon-erase pointer-cursor" style="font-size: 30px; margin-top: 10px"
                                                                              data-toggle="modal" data-target="#modalBorrarComision"></span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-xs-12 center-component">
                                                                <a class="pointer-cursor" onclick="#{comisionesMBean.abrirPdf()}" style="color: #BF0039">
                                                                    <span class="glyphicon glyphicon-save"> </span>Descargar informe
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </ui:fragment>
                                                </h:panelGroup>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-12 center-component">
                                                <ui:fragment rendered="#{comisionesMBean.mesesSinComisionar eq 1}">
                                                    <div style="background-color: #FFFFFF; border: 1px solid #F0AD4E">
                                                        <p style="height: 40px">
                                                            <span class="glyphicon glyphicon-exclamation-sign" style="color: #F0AD4E; font-size: 39px; left: 24px; position: absolute; top: 8px"> </span>
                                                            <span style="padding-left: 35px; padding-right: 20px">El asesor lleva 1 mes sin comisionar.</span>
                                                        </p>
                                                    </div>
                                                </ui:fragment>
                                                <ui:fragment rendered="#{comisionesMBean.mesesSinComisionar eq 2}">
                                                    <div style="background-color: #FFFFFF; border: 1px solid #FF5000">
                                                        <p style="height: 40px">
                                                            <span class="glyphicon glyphicon-alert" style="color: #FF5000; font-size: 39px; left: 24px; position: absolute; top: 8px"> </span>
                                                            <span style="padding-left: 30px; padding-right: 20px">El asesor lleva 2 meses sin comisionar.</span>
                                                        </p>
                                                    </div>
                                                </ui:fragment>
                                                <ui:fragment rendered="#{comisionesMBean.mesesSinComisionar gt 2}">
                                                    <div style="background-color: #FFFFFF; border: 1px solid #B94743">
                                                        <p style="height: 40px">
                                                            <span class="glyphicon glyphicon-remove-sign" style="color: #B94743; font-size: 39px; left: 24px; position: absolute; top: 8px"> </span>
                                                            <span style="padding-left: 30px; padding-right: 20px">El asesor lleva 3 meses sin comisionar.</span>
                                                        </p>
                                                    </div>
                                                </ui:fragment>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </h:panelGroup>
            </h:panelGroup>
        </h:form>
        <br/>
        <!-- script references -->
        <script src="/360/js/bootstrap.min.js"></script>
    </h:body>
</html>